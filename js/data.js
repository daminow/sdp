export const items = [
    {
        title: 'Диван кожаный',
        model: '“R-94”',
        raiting: '5,0',
        img: 'img/item/1',
        count: 94990,
        tag: [
            {
                type: 'color',
                name: 'Черный',
                value: 'black'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Кожа',
                value: 'skin'
            }
        ],
    },
    {
        title: 'Диван апартековый',
        model: '“T-75”',
        raiting: '4,9',
        img: 'img/item/2',
        count: 69990,
        tag: [
            {
                type: 'color',
                name: 'Коричневый',
                value: 'brown'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Апартек',
                value: 'apartek'
            }
        ],
    },
    {
        title: 'Диван тканевый',
        model: '“D-31”',
        raiting: '4,8',
        img: 'img/item/3',
        count: 28490,
        tag: [
            {
                type: 'color',
                name: 'Синий',
                value: 'blue'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Ткань',
                value: 'textile'
            }
        ],
    },
    {
        title: 'Диван велюровый',
        model: '“Y-68”',
        raiting: '4,8',
        img: 'img/item/4',
        count: 22990,
        tag: [
            {
                type: 'color',
                name: 'Оранжевый',
                value: 'orange'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Велюр',
                value: 'velour'
            }
        ],
    },
    {
        title: 'Диван из шинила',
        model: '“W-95”',
        raiting: '4,8',
        img: 'img/item/5',
        count: 22990,
        tag: [
            {
                type: 'color',
                name: 'Желтый',
                value: 'yellow'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Шиншил',
                value: 'chinchilla'
            }
        ],
    },
    {
        title: 'Диван флоковый',
        model: '“G-41”',
        raiting: '4,8',
        img: 'img/item/6',
        count: 17990,
        tag: [
            {
                type: 'color',
                name: 'Бежевый',
                value: 'beige'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Флок',
                value: 'flock'
            }
        ],
    },
    {
        title: 'Диван шиниловый',
        model: '“V-43”',
        raiting: '4,8',
        img: 'img/item/7',
        count: 19990,
        tag: [
            {
                type: 'color',
                name: 'Серый',
                value: 'gray'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Шиншил',
                value: 'chinchilla'
            }
        ],
    },
    {
        title: 'Диван велюровый',
        model: '“S-99”',
        raiting: '4,7',
        img: 'img/item/8',
        count: 19990,
        tag: [
            {
                type: 'color',
                name: 'Бежевый',
                value: 'beige'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Велюр',
                value: 'velour'
            }
        ],
    },
    {
        title: 'Диван из кожзама',
        model: '“F-85”',
        raiting: '4,7',
        img: 'img/item/9',
        count: 26990,
        tag: [
            {
                type: 'color',
                name: 'Зеленый',
                value: 'green'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Эко-кожа',
                value: 'eco-leather'
            }
        ],
    },
    {
        title: 'Диван флоковый',
        model: '“H-58”',
        raiting: '4,6',
        img: 'img/item/10',
        count: 23990,
        tag: [
            {
                type: 'color',
                name: 'Синий',
                value: 'blue'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Флок',
                value: 'flock'
            }
        ],
    },
    {
        title: 'Диван велюровый',
        model: '“S-44”',
        raiting: '4,5',
        img: 'img/item/11',
        count: 19990,
        tag: [
            {
                type: 'color',
                name: 'Синий',
                value: 'blue'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Велюр',
                value: 'velour'
            }
        ],
    },
    {
        title: 'Диван велюровый',
        model: '“R-85”',
        raiting: '4,5',
        img: 'img/item/12',
        count: 34990,
        tag: [
            {
                type: 'color',
                name: 'Зеленый',
                value: 'green'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Велюр',
                value: 'velour'
            }
        ],
    },
    {
        title: 'Кресло велюровое',
        model: '“X-24”',
        raiting: '4,7',
        img: 'img/item/13',
        lastCount: 24990,
        count: 15990,
        tag: [
            {
                type: 'color',
                name: 'Желтый',
                value: 'yellow'
            },
            {
                type: 'category',
                name: 'Кресла',
                value: 'armchair'
            },
            {
                type: 'material',
                name: 'Велюр',
                value: 'velour'
            }
        ],
    },
    {
        title: 'Диван тканевый',
        model: '“Z-44”',
        raiting: '4,7',
        img: 'img/item/14',
        lastCount: 32990,
        count: 22990,
        constrImg: 'img/sales2-1',
        tag: [
            {
                type: 'color',
                name: 'Белый',
                value: 'white'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Велюр',
                value: 'velour'
            }
        ],
    },
    {
        title: 'Будильник',
        model: '“Quartz-23”',
        raiting: '4,7',
        img: 'img/item/15',
        lastCount: 1890,
        count: 1290,
        tag: [
            {
                type: 'color',
                name: 'Золотой',
                value: 'gold'
            },
            {
                type: 'material',
                name: 'Метал',
                value: 'metal'
            }
        ],
    },
    {
        title: 'Мини-скульптура',
        model: '“Oh my deer”',
        raiting: '4,7',
        img: 'img/item/16',
        count: 690,
        lastCount: 990,
        tag: [
            {
                type: 'color',
                name: 'Черный',
                value: 'black'
            },
        ],
    },
    {
        title: 'Диван вел-флок',
        model: '“Z-85”',
        raiting: '4,7',
        img: 'img/item/17',
        lastCount: 32990,
        count: 22990,
        tag: [
            {
                type: 'color',
                name: 'Коричневый',
                value: 'brown'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Вел-флок',
                value: 'velflock'
            }
        ],
    },
    {
        title: 'Термометр +',
        model: 'гидрометр “H-18”',
        raiting: '4,7',
        img: 'img/item/18',
        lastCount: 2090,
        count: 1390,
        tag: [],
    },
    {
        title: 'Диван',
        model: 'IMPERIJA',
        raiting: '4,8',
        img: 'img/item/20',
        count: 330000,
        descr: 'Классика, которая всегда остается в моде. Каркас и основа из древесины бука. Спинка из литого полиуретана высокой плотности. Микро-пружины типа Pocket. Особенности: Микро пружины типа Pocket Древесина бука Полиуретан высокой плотности',
        tag: [
            {
                type: 'color',
                name: 'Розовый',
                value: 'pink'
            },
            {
                type: 'category',
                name: 'Диваны',
                value: 'sofa'
            },
            {
                type: 'material',
                name: 'Дерево',
                value: 'wood'
            }
        ],
    },
    {
        title: 'Комод',
        model: 'WING',
        raiting: '4,5',
        img: 'img/item/19',
        count: 24000,
        descr: 'Комод WING от AIKO в цвете Tiffany - стильное решение для вашего интерьера.',
        tag: [
            {
                type: 'color',
                name: 'Зеленый',
                value: 'green'
            },
            {
                type: 'category',
                name: 'Комоды',
                value: 'dresser'
            },
            {
                type: 'material',
                name: 'Дерево',
                value: 'wood'
            }
        ],
    },
]

export const categories = [
    {
        title: 'Диваны',
        img: 'img/top1.webp',
        tags: [
            {
                title: 'Прямые',
            },
            {
                title: 'Угловые',
            },
            {
                title: 'Модульные',
            }
        ],
        itemTag: 'sofa',
        special: 'col-6',
    },
    {
        title: 'Кровати',
        img: 'img/top3.webp',
        tags: [
            {
                title: 'Односпальные',
            },
            {
                title: 'Двуспальные',
            }
        ],
    },
    {
        title: 'Кресла',
        img: 'img/top2.webp',
        tags: [
            {
                title: 'Мягкие',
            },
            {
                title: 'Кресла-кровати',
            }
        ],
        itemTag: 'armchair',
        special: 'col-6',
    },
    {
        title: 'Тумбы и комоды',
        img: 'img/top4.webp',
        tags: [
            {
                title: 'Тумбы',
            },
            {
                title: 'Комоды',
            }
        ],
        itemTag: 'dresser',
    },
    {
        title: 'Стулья',
        img: 'img/top5.webp',
        tags: [
            {
                title: 'Деревянные',
            },
            {
                title: 'Металлокаркас',
            }
        ],
    }
]

export const circleSvg = `<svg width="22" height="22" viewBox="0 0 22 22" fill="false" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_11908_112)">
                                    <circle cx="11" cy="11" r="10" stroke-width="2" />
                                    <path d="M9.625 7.5625L13.0625 11L9.625 14.4375" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                </g>
                                <defs>
                                    <clipPath>
                                        <rect width="22" height="22"/>
                                    </clipPath>
                                </defs>
                            </svg>`

export const payments = [
    {
        type: 'receipt',
        title: 'При получении',
        values: [
            {
                name: 'cash',
                title: 'Наличные',
                icon: 'https://cdn-icons-png.freepik.com/256/2489/2489756.png?semt=ais_hybrid'
            },
            {
                name: 'card',
                title: 'Картой',
                icon: 'https://cdn-icons-png.flaticon.com/512/6963/6963703.png'
            },
        ]
    },
    {
        type: 'online',
        title: 'Онлайн',
        values: [
            {
                name: 'sber',
                title: 'Сбер',
                icon: 'https://www.svgrepo.com/download/367195/sberbank.svg'
            },
            {
                name: 'alfa',
                title: 'Alfa-банк',
                icon: 'https://alfabank.st/media/favicon_alfa-logo_32x32_desktop_08-08-2019.png'
            },
            {
                name: 'tbank',
                title: 'T-Bank',
                icon: 'https://acdn.tinkoff.ru/params/common_front/resourses/icons/favicon-32x32.png'
            },
        ]
    },
]

export function createElement(tag = 'div', text = '', classList = [], attrs = {}) {
    let element = document.createElement(tag)
    element.classList.add(...classList)
    element.innerHTML = text
    for (const prop in attrs) { element[prop] = attrs[prop] }
    return element
}

export function dataToJson(data) { return JSON.stringify(data) }
export function jsonToData(data) { return JSON.parse(data) }
export function getData(name) { return localStorage.getItem(name) }
export function setData(name, data) { localStorage.setItem(name, data) }

export function createIconItem() {
    const iconsList = createElement('div', '', ['header__line-icon'])
    const login = createElement('a', '', ['header__line-icon-user'], { href: 'login.html' })
    login.innerHTML = `<svg width="26" height="28" viewBox="0 0 26 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M24.98 22.8503C24.3278 21.2785 23.3813 19.8508 22.1933 18.6467C21.0089 17.4392 19.6059 16.4764 18.0617 15.8116C18.0478 15.8045 18.034 15.801 18.0202 15.794C20.1742 14.2111 21.5744 11.6327 21.5744 8.72362C21.5744 3.90452 17.7367 0 13 0C8.26333 0 4.42559 3.90452 4.42559 8.72362C4.42559 11.6327 5.82585 14.2111 7.97982 15.7975C7.96599 15.8045 7.95216 15.808 7.93833 15.8151C6.38941 16.4799 4.99952 17.4332 3.80671 18.6503C2.61981 19.8553 1.67349 21.2827 1.02003 22.8538C0.37806 24.3918 0.0318323 26.0409 8.64563e-05 27.7116C-0.000836348 27.7491 0.00563604 27.7864 0.0191224 27.8214C0.0326088 27.8564 0.0528363 27.8882 0.0786128 27.9151C0.104389 27.942 0.135194 27.9633 0.16921 27.9779C0.203227 27.9925 0.239768 28 0.27668 28H2.35113C2.50326 28 2.62427 27.8769 2.62773 27.7256C2.69688 25.01 3.76868 22.4668 5.66335 20.5392C7.62371 18.5447 10.2271 17.4472 13 17.4472C15.7729 17.4472 18.3763 18.5447 20.3367 20.5392C22.2313 22.4668 23.3031 25.01 23.3723 27.7256C23.3757 27.8804 23.4967 28 23.6489 28H25.7233C25.7602 28 25.7968 27.9925 25.8308 27.9779C25.8648 27.9633 25.8956 27.942 25.9214 27.9151C25.9472 27.8882 25.9674 27.8564 25.9809 27.8214C25.9944 27.7864 26.0008 27.7491 25.9999 27.7116C25.9653 26.0301 25.6231 24.3945 24.98 22.8503ZM13 14.7739C11.413 14.7739 9.91943 14.1442 8.79577 13.001C7.67211 11.8578 7.05323 10.3382 7.05323 8.72362C7.05323 7.10905 7.67211 5.58945 8.79577 4.44623C9.91943 3.30301 11.413 2.67337 13 2.67337C14.587 2.67337 16.0806 3.30301 17.2042 4.44623C18.3279 5.58945 18.9468 7.10905 18.9468 8.72362C18.9468 10.3382 18.3279 11.8578 17.2042 13.001C16.0806 14.1442 14.587 14.7739 13 14.7739Z"/></svg>`

    const btn = createElement('button', '', ['btn-reset', 'header__line-icon-busket'])
    let busketItems = jsonToData(getData('busket'))
    if (busketItems === null || busketItems === undefined) {
        busketItems = []
        setData('busket', dataToJson(busketItems))
    }
    const busketCount = createElement('span', busketItems.length)
    btn.addEventListener('click', () => {
        if (busketItems.length === 0) {
            modal('text', 'Корзина пуста!')
        } else { modal('buynow', busketItems) }
    })
    btn.innerHTML = '<svg width="30" height="28" viewBox="0 0 30 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M28.8162 19.8503H8.90202L9.90191 17.7365L26.5154 17.7052C27.0772 17.7052 27.5588 17.2887 27.6591 16.7125L29.9599 3.34598C30.0201 2.99541 29.9298 2.63444 29.7091 2.36023C29.6 2.22528 29.4639 2.11658 29.3103 2.04166C29.1567 1.96674 28.9892 1.9274 28.8195 1.92637L7.68476 1.85348L7.50418 0.971861C7.39048 0.40957 6.90224 0 6.34712 0H1.18047C0.86739 0 0.567133 0.129087 0.345752 0.358864C0.124371 0.588641 0 0.900285 0 1.22524C0 1.55019 0.124371 1.86184 0.345752 2.09161C0.567133 2.32139 0.86739 2.45048 1.18047 2.45048H5.3907L6.17991 6.34486L8.12284 16.1086L5.62145 20.3466C5.49155 20.5286 5.4133 20.7446 5.39557 20.9704C5.37784 21.1961 5.42134 21.4225 5.52112 21.6239C5.72177 22.0369 6.12641 22.2973 6.57452 22.2973H8.67462C8.2269 22.9145 7.98508 23.6662 7.98573 24.4388C7.98573 26.4034 9.52402 28 11.4168 28C13.3096 28 14.8478 26.4034 14.8478 24.4388C14.8478 23.6648 14.6004 22.9116 14.159 22.2973H19.5463C19.0986 22.9145 18.8568 23.6662 18.8574 24.4388C18.8574 26.4034 20.3957 28 22.2885 28C24.1813 28 25.7195 26.4034 25.7195 24.4388C25.7195 23.6648 25.4721 22.9116 25.0307 22.2973H28.8195C29.4683 22.2973 30 21.7489 30 21.072C29.9981 20.7474 29.8725 20.4368 29.6507 20.2079C29.4289 19.979 29.1289 19.8504 28.8162 19.8503ZM8.17635 4.26925L27.4317 4.33519L25.5456 15.2964L10.4202 15.3242L8.17635 4.26925ZM11.4168 25.5356C10.8349 25.5356 10.36 25.0428 10.36 24.4388C10.36 23.8349 10.8349 23.342 11.4168 23.342C11.9987 23.342 12.4735 23.8349 12.4735 24.4388C12.4735 24.7297 12.3622 25.0087 12.164 25.2144C11.9658 25.4201 11.6971 25.5356 11.4168 25.5356ZM22.2885 25.5356C21.7066 25.5356 21.2317 25.0428 21.2317 24.4388C21.2317 23.8349 21.7066 23.342 22.2885 23.342C22.8704 23.342 23.3452 23.8349 23.3452 24.4388C23.3452 24.7297 23.2339 25.0087 23.0357 25.2144C22.8375 25.4201 22.5687 25.5356 22.2885 25.5356Z"/></svg>'
    btn.prepend(busketCount)
    iconsList.append(login, btn)
    return iconsList
}

export function createIcon() {
    let flag = true
    while (flag) {
        let elem = document.querySelector('.header__line-icon')
        if (elem != null) {
            elem.remove()
        } else { flag = false }
    }
    const arrs = ['header-line-2', 'header-line-3', 'header-line-5']
    for (const arrItem of arrs) {
        const place = document.getElementById(arrItem)
        place.querySelector('.container').append(createIconItem())
    }
}

export function createAlertWindow(data, time) {
    let item = createElement('div', '', ['alert'])
    let cont = createElement('div', '', ['alert__cont'])
    let text = createElement('h2', data, ['alert__text'])
    let close = createElement('button', '', ['alert__close'])
    close.append(createElement('span', '', ['alert__close-row']), createElement('span', '', ['alert__close-row']))
    cont.append(text, close)
    item.append(cont)
    document.body.prepend(item)
    const anim = gsap.timeline()
        .pause()
        .set('.alert', { visibility: 'visible' })
        .fromTo('.alert', { opacity: 0, y: -100 }, { opacity: 0.5, y: 0, duration: .5 })
        .to('.alert', { opacity: 1, duration: .5 })
    anim.play()
    close.addEventListener('click', () => {
        anim.reverse()
        setTimeout(() => { item.remove() }, 2000)
        return
    })
    setTimeout(() => {
        anim.reverse()
        setTimeout(() => { item.remove() }, 2000)
        return
    }, (time + 3000))
}

export function searchForm() {
    const input = document.getElementById('search-input')
    const submitBtn = document.getElementById('search-submit')
    submitBtn.addEventListener('click', (event) => {
        event.preventDefault()
        if (input.value.length < 2) {
            createAlertWindow('Поле поиска должно содержать более двух символов!', 5000)
            return
        }
        setData('searchData', dataToJson(input.value))
        window.location.href = "catalog.html";
    })

    input.addEventListener('keyup', (event) => {
        if (event.key === 'Backspace' && input.value === '') { setData('searchData', dataToJson('')) }
    })
}

export function modal(type = 'text', val) {
    const modal = createElement('div', '', ['modal'], { id: 'modal' })
    const cont = createElement('div', '', ['modal__cont'])
    const logo = createElement('img', '', ['modal__logo'], { src: 'https://timurdaminov.github.io/sdp/img/logo.svg' })
    modal.append(cont)
    if (type === 'text') {
        const title = createElement('h2', val, ['modal__title'])
        cont.append(title)
    } else if (type === 'buynow') {
        let offerCound = 0
        const busketCont = createElement('div', '', ['modal__busket-cont'])
        const busketItem = createElement('ul', '', ['list-reset', 'modal__busket-list'])
        for (const itemBusket of val) {
            const cardCont = createElement('li', '', [`modal__busket-item`])
            const cardTitle = createElement('h3', '', ['modal__busket-title'])
            cardTitle.append(createElement('span', itemBusket.title, ['modal__busket-title-sp']), ' ', createElement('span', itemBusket.model, ['modal__busket-title-sp']))
            const cardCount = createElement('h4', `${itemBusket.count.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ")} руб`, ['modal__busket-count'])
            const buttonDelete = createElement('button', 'Удалить', ['btn-reset', 'modal__busket-delete'])
            buttonDelete.addEventListener('click', () => {
                val.pop(itemBusket)
                setData('busket', dataToJson(val))
                if (val.length === 0) { closeModalEvent() }
                createIcon()
                cardCont.remove()
                offerCound -= itemBusket.count
                offerCountCont.textContent = `Итог: ${offerCound.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ")} руб`
            })
            offerCound += itemBusket.count
            cardCont.append(cardTitle, cardCount, buttonDelete)
            busketItem.append(cardCont)
        }
        const offerCountCont = createElement('h3', `Итог: ${offerCound.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ")} руб`, ['modal__busket-offer'])
        busketCont.append(busketItem, offerCountCont)
        const form = createElement('form', '', ['modal__form'])
        const title = createElement('h2', 'Оформление заказа', ['modal__title'])
        const name = createElement('div', '', ['modal__form-item'])
        const nameInput = createElement('input', '', ['modal__form-item-input'], { type: 'text', id: 'modal-name', required: true })
        const nameLabel = createElement('label', 'Фамилия Имя Отчество', ['modal__form-item-label'], { for: 'modal-name' })
        name.append(nameInput, nameLabel)
        nameInput.addEventListener('input', () => {
            nameInput.value = nameInput.value.replace(/[^A-Za-zА-Яа-я]/g, '');
        })

        const tel = createElement('div', '', ['modal__form-item'])
        const telInput = createElement('input', '', ['modal__form-item-input'], { type: 'text', id: 'modal-tel', required: true })
        telInput.setAttribute('maxlength', 16)
        const telLabel = createElement('label', 'Ваш телефон', ['modal__form-item-label'], { for: 'modal-tel' })
        tel.append(telInput, telLabel)
        telInput.addEventListener('input', function (event) {
            let inputValue = event.target.value;
            let filteredValue = inputValue.replace(/\D/g, '');
            let formattedValue = '+7 ';
            for (let i = 1; i < filteredValue.length; i++) {
                if (i === 4 || i === 7 || i === 9) { formattedValue += ' '; }
                formattedValue += filteredValue[i];
            }
            telInput.value = formattedValue;
        })

        const email = createElement('div', '', ['modal__form-item'])
        const emailInput = createElement('input', '', ['modal__form-item-input'], { type: 'text', id: 'modal-mail', required: true })
        const emailLabel = createElement('label', 'Ваш e-mail', ['modal__form-item-label'], { for: 'modal-mail' })
        email.append(emailInput, emailLabel)
        emailInput.addEventListener('input', () => {
            let filteredEmail = emailInput.value.replace(/[^a-zA-Z0-9@._-]/g, "");
            emailInput.value = filteredEmail;
        })

        const city = createElement('div', '', ['modal__form-item'])
        const cityInput = createElement('input', '', ['modal__form-item-input'], { type: 'text', id: 'modal-city', required: true })
        const cityLabel = createElement('label', 'Город доставки', ['modal__form-item-label'], { for: 'modal-city' })
        city.append(cityInput, cityLabel)
        cityInput.addEventListener('input', () => {
            cityInput.value = cityInput.value.replace(/[^A-Za-zА-Яа-я]/g, '');
        })

        const adress = createElement('div', '', ['modal__form-item'])
        const adressInput = createElement('input', '', ['modal__form-item-input'], { type: 'text', id: 'modal-adress', required: true })
        const adressLabel = createElement('label', 'Район, дом/квартира', ['modal__form-item-label'], { for: 'modal-adress' })
        adress.append(adressInput, adressLabel)

        const post = createElement('div', '', ['modal__form-item'])
        const postInput = createElement('input', '', ['modal__form-item-input'], { type: 'text', id: 'modal-post', required: true })
        postInput.setAttribute('maxlength', 6)
        const postLabel = createElement('label', 'Почтовый индекс', ['modal__form-item-label'], { for: 'modal-post' })
        post.append(postInput, postLabel)
        postInput.addEventListener('input', () => {
            postInput.value = postInput.value.replace(/\D/g, '');
        })


        const paymentCont = createElement('div', '', ['modal__form-payment'])
        const paymentTypeList = createElement('ul', '', ['list-reset', 'modal__form-payment-type-list'])
        const paymentValueList = createElement('div', '', ['modal__form-payment-value'])
        const paymentTitle = createElement('h3', 'Способы оплаты:', ['modal__form-payment-title'])
        let paymentVal = null
        let cardInfo = {}
        paymentCont.append(paymentTitle, paymentTypeList, paymentValueList)
        for (const paymentType of payments) {
            const paymentTypeCont = createElement('div', '', ['modal__form-payment-type'])
            const paymentTypeInput = createElement('input', '', ['modal__form-payment-type-input'], { type: 'radio', id: paymentType.type, name: 'paymentType', value: paymentType.type })
            const paymentTypeLabel = createElement('label', paymentType.title, ['modal__form-payment-type-label'])
            paymentTypeLabel.setAttribute('for', paymentType.type);
            paymentTypeCont.append(paymentTypeInput, paymentTypeLabel)
            paymentTypeList.append(paymentTypeCont)

            const paymentValueItemList = createElement('ul', '', ['list-reset', 'modal__form-payment-value-list'])
            paymentValueList.append(paymentValueItemList)
            paymentTypeInput.addEventListener('click', () => {
                if (paymentTypeInput.checked) {
                    if (document.querySelector('.open') != null) {
                        document.querySelector('.open').classList.remove('open')
                    }
                    paymentValueItemList.classList.add('open')
                }
            })
            for (const paymentValue of paymentType.values) {
                const paymentValueItem = createElement('li', '', ['modal__form-payment-type'])
                const paymentValueItemInput = createElement('input', '', ['modal__form-payment-type-input'], { name: 'payment-value', id: `${paymentType}-${paymentValue.name}`, type: 'radio', value: paymentValue.name })
                const paymentValueItemLabel = createElement('label', paymentValue.title, ['modal__form-payment-type-label'])
                const paymentValueItemIcon = createElement('img', '', ['modal__form-payment-type-icon'], { src: paymentValue.icon })
                paymentValueItemLabel.prepend(paymentValueItemIcon)
                paymentValueItemLabel.setAttribute('for', `${paymentType}-${paymentValue.name}`);
                paymentValueItem.append(paymentValueItemInput, paymentValueItemLabel)

                paymentValueItemList.append(paymentValueItem)
                paymentValueItemInput.addEventListener('click', () => {
                    paymentVal = paymentTypeInput.value
                    if (paymentTypeInput.value === 'online' && paymentValueItemInput.checked && document.querySelector('.modal__form-payment-card-list') === null) {
                        const paymentCardNum = createElement('li', '', ['modal__form-payment-card'])
                        const paymentCardNumInput = createElement('input', '', ['modal__form-payment-card-input'], { id: 'payment-card-num', type: 'text', required: true })
                        const paymentCardNumLabel = createElement('label', 'Номер карты', ['modal__form-payment-card-label'])
                        paymentCardNumLabel.setAttribute('for', 'payment-card-num')
                        paymentCardNumInput.setAttribute('maxlength', 19)
                        paymentCardNumInput.addEventListener('input', () => {
                            paymentCardNumInput.value = paymentCardNumInput.value.replace(/\D/g, '');
                            if (paymentCardNumInput.value.length > 0) {
                                paymentCardNumInput.value = paymentCardNumInput.value.match(new RegExp('.{1,4}', 'g')).join(' ');
                            }
                            if (paymentCardNumInput.value.length === 19) {
                                cardInfo.number = paymentCardNumInput.value
                            }
                            checkValidInput(nameInput, telInput, cityInput, emailInput, adressInput, postInput, paymentVal, completeBtn)
                        })
                        paymentCardNum.append(paymentCardNumInput, paymentCardNumLabel)

                        const paymentCardDate = createElement('li', '', ['modal__form-payment-card'])
                        const paymentCardDateInput = createElement('input', '', ['modal__form-payment-card-input'], { id: 'payment-card-date', type: 'text', required: true })
                        const paymentCardDateLabel = createElement('label', 'Срок действия', ['modal__form-payment-card-label'])
                        paymentCardDateLabel.setAttribute('for', 'payment-card-date')
                        paymentCardDateInput.setAttribute('maxlength', 7)
                        paymentCardDate.append(paymentCardDateInput, paymentCardDateLabel)
                        paymentCardDateInput.addEventListener('keyup', function (event) {
                            paymentCardDateInput.value.replace(/\D/g, '');
                            if (event.key != 'Backspace' && event.key != 'Delete') {
                                filterCardDate(paymentCardDateInput, cardInfo)
                            }
                            checkValidInput(nameInput, telInput, cityInput, emailInput, adressInput, postInput, paymentVal, completeBtn)
                        })

                        const paymentCardCvv = createElement('li', '', ['modal__form-payment-card'])
                        const paymentCardCvvInput = createElement('input', '', ['modal__form-payment-card-input'], { id: 'payment-card-cvv', required: true })
                        const paymentCardCvvLabel = createElement('label', 'CVV код', ['modal__form-payment-card-label'])
                        paymentCardCvvLabel.setAttribute('for', 'payment-card-cvv')
                        paymentCardCvvInput.setAttribute('maxlength', 3)
                        paymentCardCvvInput.addEventListener('input', () => {
                            paymentCardCvvInput.value = paymentCardCvvInput.value.replace(/\D/g, '');
                            if (paymentCardCvvInput.value.length === 3) {
                                cardInfo.cvv = paymentCardCvvInput.value
                            }
                            checkValidInput(nameInput, telInput, cityInput, emailInput, adressInput, postInput, paymentVal, completeBtn)
                        })
                        paymentCardCvv.append(paymentCardCvvInput, paymentCardCvvLabel)

                        const cardInfoList = createElement('ul', '', ['list-reset', 'modal__form-payment-card-list'])
                        cardInfoList.append(paymentCardNum, paymentCardDate, paymentCardCvv)
                        paymentCont.append(cardInfoList)
                    } else if (paymentTypeInput.value === 'receipt' && paymentValueItemInput.checked) {
                        const cardIn = document.querySelector('.modal__form-payment-card-list')
                        if (cardIn != null) {
                            cardIn.remove()
                            cardInfo = {}
                        }
                    }
                })
            }
        }
        const completeBtn = createElement('button', 'Оформить заказ', ['btn-reset', 'modal__form-buy'], { type: 'submit', disabled: true })
        completeBtn.addEventListener('click', (event) => {
            event.preventDefault()
            setTimeout(() => {
                busketCont.remove()
                form.remove()
                title.textContent = 'Спасибо за заказ, ожидайте звонка!'
                window.addEventListener('keyup', (e) => { if (e.key === "Escape") { closeModalEvent() } });
                document.querySelector("#modal .modal__cont").addEventListener('click', event => { event._isClickWithInModal = true; });
                document.getElementById("modal").addEventListener('click', event => { if (event._isClickWithInModal) return; closeModalEvent() });
            }, 2000)
        })
        form.append(name, city, tel, adress, email, post, paymentCont, completeBtn)
        cont.append(title, busketCont, form)
    }
    const close = createElement('button', '', ['btn-reset', 'modal__close'])
    close.prepend(createElement('span'), createElement('span'))
    cont.prepend(close, logo)
    document.body.append(modal)
    let modalUse
    modalUse = gsap.timeline()
        .pause()
        .set('#modal', { opacity: 0, visibility: 'visible' })
        .fromTo('#modal', { opacity: 0 }, { duration: .1, opacity: 1 })
        .fromTo('.modal__cont', { scale: 0 }, { scale: 1, duration: 0.1 })


    modalUse.play()
    const closeModalEvent = () => {
        modalUse.reverse()
        setTimeout(() => {
            modal.remove()
        }, 1000)
    }
    close.addEventListener('click', () => {
        closeModalEvent()
    })
    if (type === 'text') {
        window.addEventListener('keyup', (e) => { if (e.key === "Escape") { closeModalEvent() } });
        document.querySelector("#modal .modal__cont").addEventListener('click', event => { event._isClickWithInModal = true; });
        document.getElementById("modal").addEventListener('click', event => { if (event._isClickWithInModal) return; closeModalEvent() });
    }
}

export function checkValidInput(nameInput, telInput, cityInput, emailInput, adressInput, postInput, paymentVal, completeBtn) {
    if (nameInput.value != '' && telInput.value.length === 16 && cityInput.value != '' &&
        (emailInput.value != '' && emailInput.value.includes('@') && emailInput.value.includes('.'))
        && adressInput.value != '' && postInput.value.length === 6 && paymentVal != null) {
        completeBtn.disabled = false
    } else {
        completeBtn.disabled = true
    }
}

function filterCardDate(paymentCardDateInput, cardInfo) {
    if (paymentCardDateInput.value.length === 2 && paymentCardDateInput.value.includes(' ') === false && paymentCardDateInput.value.includes('/') === false) {
        paymentCardDateInput.value += ' / '
    }
    if (paymentCardDateInput.value.length === 1) {
        const cardMonth = parseInt(paymentCardDateInput.value.slice(0, 2));
        if (cardMonth < 1 || cardMonth > 12) {
            createAlertWindow('Месяц действия карты должен быть более 1 и менее 13', 5000)
            paymentCardDateInput.value = ''
            return
        }
    }
    if (paymentCardDateInput.value.length === 7) {
        const cardMonth = parseInt(paymentCardDateInput.value.slice(0, 2));
        const cardYear = parseInt(paymentCardDateInput.value.slice(4)) + 2000;
        const currentDate = new Date();
        const currentYear = currentDate.getFullYear();
        const currentMonth = currentDate.getMonth() + 1;
        if (cardYear < (currentYear - 1)) {
            createAlertWindow('Год действия карты должен быть не менее 24', 5000)
            paymentCardDateInput.value = ''
            return
        }
        if (cardMonth < currentMonth && cardYear === currentYear) {
            createAlertWindow('Дата введена неверно', 5000)
            paymentCardDateInput.value = ''
            return
        }
        cardInfo.date = paymentCardDateInput.value
    }
}
